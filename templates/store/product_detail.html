{% extends 'store/base.html' %}
{% load static %}

{% block title %}{{ product.name }} - Fashion Store{% endblock %}

{% block content %}
<div class="container" style="margin-top: 40px;">
    <div class="product-detail">
        <div>
            {% if product.image %}
                <img src="{{ product.image.url }}" alt="{{ product.name }}" class="product-detail-image">
            {% else %}
                <div class="product-detail-image" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); display: flex; align-items: center; justify-content: center; color: white; font-size: 128px; height: 500px;">
                    <i class="fas fa-tshirt"></i>
                </div>
            {% endif %}
        </div>
        
        <div class="product-detail-info">
            <h1>{{ product.name }}</h1>
            <p style="color: #6c757d; margin-bottom: 20px;">
                <i class="fas fa-tag"></i> {{ product.category.name }}
            </p>
            <p class="product-detail-price">{{ product.price }} MAD</p>
            
            <div class="product-detail-description">
                <h3 style="margin-bottom: 15px;">Description</h3>
                <p>{{ product.description }}</p>
            </div>
            
            <div style="margin-bottom: 20px;">
                {% if product.stock > 0 %}
                    <p style="color: #28a745; font-weight: 600;">
                        <i class="fas fa-check-circle"></i> En stock ({{ product.stock }} disponible{{ product.stock|pluralize }})
                    </p>
                {% else %}
                    <p style="color: #dc3545; font-weight: 600;">
                        <i class="fas fa-times-circle"></i> Rupture de stock
                    </p>
                {% endif %}
            </div>
            
            {% if product.stock > 0 %}
                <form method="post" action="{% url 'store:add_to_cart' product.slug %}" style="display: flex; gap: 15px; align-items: center;">
                    {% csrf_token %}
                    <label for="id_quantity">Quantité :</label>
                    {{ form.quantity }}
                    <button type="submit" class="btn">
                        <i class="fas fa-shopping-cart"></i> Ajouter au panier
                    </button>
                </form>
            {% endif %}
        </div>
    </div>
    
    <!-- Related Products -->
    {% if related_products %}
        <div style="margin-top: 80px;">
            <h2 style="margin-bottom: 30px;">Produits similaires</h2>
            <div class="products-grid">
                {% for related in related_products %}
                    <div class="product-card">
                        {% if related.image %}
                            <img src="{{ related.image.url }}" alt="{{ related.name }}" class="product-image">
                        {% else %}
                            <div class="product-image" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); display: flex; align-items: center; justify-content: center; color: white; font-size: 48px;">
                                <i class="fas fa-tshirt"></i>
                            </div>
                        {% endif %}
                        <div class="product-info">
                            <h3 class="product-name">{{ related.name }}</h3>
                            <p class="product-price">{{ related.price }} MAD</p>
                            <a href="{% url 'store:product_detail' related.slug %}" class="btn">Voir détails</a>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>
    {% endif %}
</div>
{% endblock %}